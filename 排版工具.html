<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰æ–‡è®­è¯»æ’ç‰ˆå·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Hiragino Mincho ProN", "Yu Mincho", "MS Mincho", serif;
            background-color: #f8f3e6;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #8b0000 0%, #a52a2a 100%);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(5px);
        }

        .input-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f6f0;
            border-radius: 10px;
            border: 2px solid #d4c9a8;
        }

        .input-section h3 {
            margin-bottom: 15px;
            color: #8b0000;
            font-size: 1.3em;
        }

        .input-tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 2px solid #d4c9a8;
        }

        .input-tab {
            padding: 8px 16px;
            cursor: pointer;
            background: #d4c9a8;
            color: #5d4037;
            border: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            font-weight: bold;
        }

        .input-tab.active {
            background: #8b0000;
            color: white;
        }

        .input-panel {
            display: none;
        }

        .input-panel.active {
            display: block;
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .input-group label {
            font-weight: bold;
            min-width: 80px;
            color: #5d4037;
        }

        .input-group input,
        .input-group textarea {
            flex: 1;
            padding: 10px;
            border: 2px solid #d4c9a8;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
            min-width: 200px;
        }

        .input-group textarea {
            min-height: 120px;
            font-family: monospace;
            line-height: 1.5;
        }

        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #8b0000;
            box-shadow: 0 0 5px rgba(139, 0, 0, 0.3);
        }

        .format-hint {
            font-size: 0.9em;
            color: #666;
            margin: -10px 0 15px 80px;
            font-family: monospace;
        }

        .checkbox-group {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            padding-left: 80px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .position-controls {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
        }

        .position-controls h4 {
            margin-bottom: 15px;
            color: #8b0000;
        }

        .position-slider-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 10px;
        }

        .position-slider {
            flex: 1;
            min-width: 250px;
        }

        .position-slider label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #5d4037;
        }

        .position-slider input {
            width: 100%;
        }

        .position-value {
            display: inline-block;
            width: 30px;
            text-align: center;
            color: #8b0000;
            font-weight: bold;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #8b0000 0%, #a52a2a 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .btn-toggle {
            background: linear-gradient(135deg, #1565c0 0%, #2196f3 100%);
            color: white;
        }

        .btn-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .display-section {
            margin-top: 30px;
            padding: 20px;
            background: #fefdf9;
            border-radius: 10px;
            border: 2px solid #d4c9a8;
            min-height: 200px;
        }

        .display-section h3 {
            margin-bottom: 20px;
            color: #8b0000;
            font-size: 1.3em;
        }

        .container {
            margin: 20px 0;
            padding: 20px;
            background: rgba(212, 201, 168, 0.1);
            border-radius: 10px;
            transition: all 0.5s ease;
            display: flex;
            justify-content: center;
        }

        .sentence-box {
            position: relative;
            padding: 30px;
            border: 2px solid rgba(139, 0, 0, 0.6);
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            display: inline-block;
        }

        .sentence-box:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-color: #8b0000;
        }

        .kanji-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .kanji-container.vertical {
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }

        .kanji-item {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 90px;
            height: 90px;
        }

        .kanji {
            font-size: 48px;
            text-align: center;
            line-height: 1;
            color: #2c2c2c;
            font-weight: bold;
        }

        .ten-ten {
            position: absolute;
            font-size: 16px;
            text-align: center;
            line-height: 24px;
            border-radius: 50%;
            color: #8b0000;
            font-weight: bold;
            width: 24px;
            height: 24px;
        }

        .okurigana {
            position: absolute;
            font-size: 14px;
            text-align: center;
            line-height: 24px;
            border-radius: 50%;
            color: #5d4037;
            font-weight: bold;
            width: 30px;
            height: 24px;
        }

        .show-boxes .ten-ten,
        .show-boxes .okurigana {
            border: 1px solid rgba(139, 0, 0, 0.8);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .font-size-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .font-size-control label {
            font-weight: bold;
            color: #5d4037;
        }

        .font-size-control input[type="range"] {
            width: 150px;
        }

        .font-size-value {
            font-weight: bold;
            color: #8b0000;
            min-width: 30px;
        }

        .preset-examples {
            margin-top: 20px;
            padding: 15px;
            background: #f9f6f0;
            border-radius: 10px;
            border: 2px solid #d4c9a8;
        }

        .preset-examples h4 {
            margin-bottom: 10px;
            color: #8b0000;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .preset-btn {
            padding: 8px 16px;
            background: #d4c9a8;
            color: #5d4037;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .preset-btn:hover {
            background: #8b0000;
            color: white;
            transform: translateY(-1px);
        }

        .info-box {
            margin-top: 20px;
            padding: 15px;
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            border-radius: 5px;
        }

        .info-box h4 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
            color: #5d4037;
        }

        .info-box li {
            margin-bottom: 5px;
        }

        .error-message {
            color: #d32f2f;
            margin: 10px 0;
            padding: 10px;
            background: #ffebee;
            border-radius: 5px;
            display: none;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .kanji {
                font-size: 42px;
            }
            
            .input-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .input-group label {
                min-width: auto;
            }
            
            .checkbox-group {
                padding-left: 0;
                justify-content: center;
            }
            
            .format-hint {
                margin-left: 0;
            }
        }
    </style>
<base target="_blank">
</head>
<body>
    <div class="header">
        <h1>æ±‰æ–‡è®­è¯»æ’ç‰ˆå·¥å…·</h1>
        <p>æ”¯æŒè¿”ç‚¹æ ‡æ³¨ã€é€å‡åæ˜¾ç¤ºå’Œæ¨ªç«–æ’åˆ‡æ¢çš„ä¸“ä¸šæ’ç‰ˆç³»ç»Ÿ</p>
    </div>

    <div class="main-container">
        <div class="input-section">
            <h3>ğŸ“œ è¾“å…¥æ±‰æ–‡è®­è¯»æ•°æ®</h3>
            
            <!-- æ–°å¢æ ‡ç­¾é¡µåˆ‡æ¢è¾“å…¥æ–¹å¼ -->
            <div class="input-tabs">
                <button class="input-tab active" onclick="switchInputMode('simple')">ç®€æ˜“è¾“å…¥</button>
                <button class="input-tab" onclick="switchInputMode('advanced')">æ ‡å‡†æ ¼å¼è¾“å…¥</button>
            </div>
            
            <!-- ç®€æ˜“è¾“å…¥é¢æ¿ -->
            <div class="input-panel active" id="simple-input">
                <div class="input-group">
                    <label>æ±‰æ–‡è¯—å¥ï¼š</label>
                    <input type="text" id="kanjiInput" placeholder="è¯·è¾“å…¥æ±‰æ–‡ï¼Œå¦‚ï¼šå£°å£°æ–­äººè‚ " />
                </div>
                <div class="input-group">
                    <label>è¿”ç‚¹æ ‡æ³¨ï¼š</label>
                    <input type="text" id="tenInput" placeholder="å¯¹åº”æ¯ä¸ªå­—çš„è¿”ç‚¹ï¼Œå¦‚ï¼šï¼ŒäºŒï¼Œä¸€ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰" />
                </div>
                <div class="input-group">
                    <label>é€å‡åï¼š</label>
                    <input type="text" id="okuriganaInput" placeholder="å¯¹åº”æ¯ä¸ªå­—çš„é€å‡åï¼Œå¦‚ï¼šï¼Œãƒ¢ï¼Œãƒ„ï¼Œãƒï¼Œãƒ²ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰" />
                </div>
            </div>
            
            <!-- æ ‡å‡†æ ¼å¼è¾“å…¥é¢æ¿ -->
            <div class="input-panel" id="advanced-input">
                <div class="input-group">
                    <label>æ•°æ®æ ¼å¼ï¼š</label>
                    <textarea id="formattedInput" placeholder='è¯·è¾“å…¥æˆ–ç²˜è´´æ ‡å‡†æ ¼å¼æ•°æ®ï¼Œä¾‹å¦‚ï¼š
[
    ["å£°", "", ""],
    ["å£°", "", "ãƒ¢"],
    ["æ–­", "äºŒ", "ãƒ„"],
    ["äºº", "", "ãƒ"],
    ["è‚ ", "ä¸€", "ãƒ²"]
]'></textarea>
                </div>
                <div class="format-hint">
                    æ ¼å¼è¯´æ˜ï¼š[["æ±‰å­—", "è¿”ç‚¹", "é€å‡å"], ["æ±‰å­—", "è¿”ç‚¹", "é€å‡å"], ...]
                </div>
                <div class="error-message" id="formatError">æ•°æ®æ ¼å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥æ˜¯å¦ç¬¦åˆè¦æ±‚</div>
            </div>
            
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="showTenTen" checked>
                    <label for="showTenTen">æ˜¾ç¤ºè¿”ç‚¹</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="showOkurigana" checked>
                    <label for="showOkurigana">æ˜¾ç¤ºé€å‡å</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="showBoxes">
                    <label for="showBoxes">æ˜¾ç¤ºå°æ¡†è¾¹æ¡†</label>
                </div>
            </div>

            <div class="position-controls">
                <h4>ğŸ”§ ä½ç½®è°ƒæ•´ï¼š</h4>
                <div class="position-slider-group">
                    <div class="position-slider">
                        <label>è¿”ç‚¹ X åç§»: <span class="position-value" id="tenXValue">14</span>px</label>
                        <input type="range" id="tenXSlider" min="-60" max="60" value="14" oninput="updatePosition()">
                    </div>
                    <div class="position-slider">
                        <label>è¿”ç‚¹ Y åç§»: <span class="position-value" id="tenYValue">41</span>px</label>
                        <input type="range" id="tenYSlider" min="-60" max="60" value="41" oninput="updatePosition()">
                    </div>
                </div>
                <div class="position-slider-group">
                    <div class="position-slider">
                        <label>é€å‡å X åç§»: <span class="position-value" id="okuXValue">15</span>px</label>
                        <input type="range" id="okuXSlider" min="-60" max="60" value="15" oninput="updatePosition()">
                    </div>
                    <div class="position-slider">
                        <label>é€å‡å Y åç§»: <span class="position-value" id="okuYValue">-17</span>px</label>
                        <input type="range" id="okuYSlider" min="-60" max="60" value="-17" oninput="updatePosition()">
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn-primary" onclick="generateKundoku()">ğŸ“ ç”Ÿæˆæ’ç‰ˆ</button>
                <button class="btn-secondary" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
                <button class="btn-toggle" onclick="toggleLayout()">ğŸ”„ åˆ‡æ¢æ¨ªç«–æ’</button>
            </div>

            <div class="preset-examples">
                <h4>ğŸ¨ é¢„è®¾ç¤ºä¾‹ï¼š</h4>
                <div class="preset-buttons">
                    <button class="preset-btn" onclick="loadExample('example1')">ä¾‹1ï¼šå£°å£°æ–­äººè‚ </button>
                    <button class="preset-btn" onclick="loadExample('example2')">ä¾‹2ï¼šæ˜¥çœ ä¸è§‰æ™“</button>
                    <button class="preset-btn" onclick="loadExample('example3')">ä¾‹3ï¼šåºŠå‰æ˜æœˆå…‰</button>
                </div>
            </div>
        </div>

        <div class="display-section">
            <h3>ğŸ“Š æ’ç‰ˆé¢„è§ˆ</h3>
            <div class="container" id="kanjiContainer">
                <!-- è‡ªåŠ¨ç”Ÿæˆçš„å¥å­æ¡† -->
            </div>
            
            <div class="controls">
                <div class="font-size-control">
                    <label>å­—ä½“å¤§å°ï¼š</label>
                    <input type="range" id="fontSizeSlider" min="30" max="70" value="48" onchange="updateFontSize()">
                    <span class="font-size-value" id="fontSizeValue">48px</span>
                </div>
            </div>
        </div>

        <div class="info-box">
            <h4>ğŸ“Œ ä½¿ç”¨è¯´æ˜ï¼š</h4>
            <ul>
                <li><strong>è¾“å…¥æ–¹å¼</strong>ï¼šæ”¯æŒç®€æ˜“è¾“å…¥ï¼ˆåˆ†åˆ«è¾“å…¥æ±‰å­—ã€è¿”ç‚¹ã€é€å‡åï¼‰å’Œæ ‡å‡†æ ¼å¼è¾“å…¥ï¼ˆç›´æ¥è¾“å…¥æ•°ç»„æ ¼å¼æ•°æ®ï¼‰</li>
                <li><strong>è¿”ç‚¹æ ‡æ³¨</strong>ï¼šç”¨äºæ ‡è®°æ±‰æ–‡é˜…è¯»é¡ºåºçš„ç‰¹æ®Šç¬¦å·ï¼Œå¦‚ä¸€ã€äºŒã€ä¸Šã€ä¸‹ã€ãƒ¬ç­‰</li>
                <li><strong>é€å‡å</strong>ï¼šæ ‡æ³¨åœ¨æ±‰å­—å³ä¸‹è§’çš„å‡åï¼Œç”¨äºæç¤ºæ±‰å­—çš„æ—¥è¯­è¯»éŸ³</li>
                <li><strong>æ˜¾ç¤ºæ§åˆ¶</strong>ï¼šå¯åˆ†åˆ«æ§åˆ¶è¿”ç‚¹ã€é€å‡ååŠå…¶è¾¹æ¡†çš„æ˜¾ç¤ºçŠ¶æ€</li>
                <li><strong>ä½ç½®è°ƒæ•´</strong>ï¼šé€šè¿‡æ»‘å—å¯å¾®è°ƒè¿”ç‚¹å’Œé€å‡åç›¸å¯¹äºæ±‰å­—çš„ä½ç½®</li>
                <li><strong>æ¨ªç«–æ’åˆ‡æ¢</strong>ï¼šç‚¹å‡»æŒ‰é’®å¯åœ¨æ¨ªå‘æ’åˆ—å’Œçºµå‘æ’åˆ—ä¹‹é—´åˆ‡æ¢</li>
            </ul>
        </div>
    </div>

    <script>
        // å½“å‰æ¿€æ´»çš„è¾“å…¥æ¨¡å¼
        let currentInputMode = 'simple';
        
        // é¢„è®¾ç¤ºä¾‹æ•°æ®
        const examples = {
            example1: [
                ["å£°", "", ""],
                ["å£°", "", "ãƒ¢"],
                ["æ–­", "äºŒ", "ãƒ„"],
                ["äºº", "", "ãƒ"],
                ["è‚ ", "ä¸€", "ãƒ²"]
            ],
            example2: [
                ["æ˜¥", "", ""],
                ["çœ ", "ãƒ¬", ""],
                ["ä¸", "", "ã‚·"],
                ["è§‰", "", "ãƒ¡"],
                ["æ™“", "", "ã‚®"]
            ],
            example3: [
                ["åºŠ", "", ""],
                ["å‰", "", "ã‚³"],
                ["æ˜", "", "ãƒ"],
                ["æœˆ", "", "ã‚²"],
                ["å…‰", "", "ã‚³"]
            ]
        };

        // åˆ‡æ¢è¾“å…¥æ¨¡å¼ï¼ˆç®€æ˜“/æ ‡å‡†æ ¼å¼ï¼‰
        function switchInputMode(mode) {
            currentInputMode = mode;
            
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.input-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.input-tab[onclick="switchInputMode('${mode}')"]`).classList.add('active');
            
            // æ›´æ–°é¢æ¿çŠ¶æ€
            document.querySelectorAll('.input-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById(`${mode}-input`).classList.add('active');
            
            // éšè—é”™è¯¯ä¿¡æ¯
            document.getElementById('formatError').style.display = 'none';
        }

        // åŠ è½½ç¤ºä¾‹
        function loadExample(exampleKey) {
            const exampleData = examples[exampleKey];
            if (!exampleData) return;
            
            // æ ¹æ®å½“å‰è¾“å…¥æ¨¡å¼å¡«å……ä¸åŒçš„è¾“å…¥æ¡†
            if (currentInputMode === 'simple') {
                const kanjiArray = exampleData.map(item => item[0]);
                const tenArray = exampleData.map(item => item[1]);
                const okuriganaArray = exampleData.map(item => item[2]);
                
                document.getElementById('kanjiInput').value = kanjiArray.join('');
                document.getElementById('tenInput').value = tenArray.join(',');
                document.getElementById('okuriganaInput').value = okuriganaArray.join(',');
            } else {
                // æ ¼å¼åŒ–JSONä»¥ä¾¿é˜…è¯»
                const formattedJson = JSON.stringify(exampleData, null, 4)
                    .replace(/\[\s+/g, '[')
                    .replace(/\s+\]/g, ']')
                    .replace(/\"/g, '"');
                
                document.getElementById('formattedInput').value = formattedJson;
            }
            
            // ç”Ÿæˆæ’ç‰ˆ
            renderFromData(exampleData);
        }

        // ä»è¾“å…¥ç”Ÿæˆè®­è¯»æ’ç‰ˆ
        function generateKundoku() {
            let data = null;
            const errorElement = document.getElementById('formatError');
            errorElement.style.display = 'none';
            
            try {
                if (currentInputMode === 'simple') {
                    // å¤„ç†ç®€æ˜“è¾“å…¥
                    const kanjiText = document.getElementById('kanjiInput').value.trim();
                    const tenText = document.getElementById('tenInput').value.trim();
                    const okuriganaText = document.getElementById('okuriganaInput').value.trim();
                    
                    if (!kanjiText) {
                        alert('è¯·è¾“å…¥æ±‰æ–‡è¯—å¥ï¼');
                        return;
                    }

                    const kanjiArray = Array.from(kanjiText);
                    const tenArray = tenText ? tenText.split(',').map(t => t.trim()) : [];
                    const okuriganaArray = okuriganaText ? okuriganaText.split(',').map(o => o.trim()) : [];
                    
                    const maxLength = Math.max(kanjiArray.length, tenArray.length, okuriganaArray.length);
                    
                    while (kanjiArray.length < maxLength) kanjiArray.push('');
                    while (tenArray.length < maxLength) tenArray.push('');
                    while (okuriganaArray.length < maxLength) okuriganaArray.push('');

                    data = kanjiArray.map((kanji, index) => [
                        kanji || '',
                        tenArray[index] || '',
                        okuriganaArray[index] || ''
                    ]);
                } else {
                    // å¤„ç†æ ‡å‡†æ ¼å¼è¾“å…¥
                    const inputText = document.getElementById('formattedInput').value.trim();
                    if (!inputText) {
                        alert('è¯·è¾“å…¥æ ‡å‡†æ ¼å¼æ•°æ®ï¼');
                        return;
                    }
                    
                    // è§£æJSONæ•°æ®
                    data = JSON.parse(inputText);
                    
                    // éªŒè¯æ•°æ®æ ¼å¼
                    if (!Array.isArray(data) || data.some(item => 
                        !Array.isArray(item) || item.length !== 3 || 
                        typeof item[0] !== 'string' || 
                        typeof item[1] !== 'string' || 
                        typeof item[2] !== 'string'
                    )) {
                        throw new Error('æ•°æ®æ ¼å¼ä¸æ­£ç¡®');
                    }
                }
                
                // æ¸²æŸ“æ’ç‰ˆ
                renderFromData(data);
            } catch (e) {
                console.error('è§£ææ•°æ®å‡ºé”™:', e);
                errorElement.textContent = `æ•°æ®æ ¼å¼é”™è¯¯: ${e.message}`;
                errorElement.style.display = 'block';
                return;
            }
        }

        /**
         * ä»æ ‡å‡†æ•°æ®æ ¼å¼æ¸²æŸ“è®­è¯»æ’ç‰ˆ
         * @param {Array} data - æ ¼å¼ä¸º [[æ±‰å­—, è¿”ç‚¹, é€å‡å], ...] çš„æ•°ç»„
         */
        function renderFromData(data) {
            const container = document.getElementById('kanjiContainer');
            container.innerHTML = '';
            
            const sentenceBox = document.createElement('div');
            sentenceBox.className = 'sentence-box';
            
            const kanjiContainer = document.createElement('div');
            kanjiContainer.className = 'kanji-container vertical';
            
            if (document.getElementById('showBoxes').checked) {
                kanjiContainer.classList.add('show-boxes');
            }
            
            data.forEach(item => {
                const [kanji, tenTen, okurigana] = item;
                const kanjiItem = document.createElement('div');
                kanjiItem.className = 'kanji-item';
                
                let innerHTML = `<div class="kanji">${kanji}</div>`;
                
                const showTenTen = document.getElementById('showTenTen').checked;
                const showOkurigana = document.getElementById('showOkurigana').checked;
                
                if (tenTen && showTenTen) {
                    innerHTML += `<div class="ten-ten">${tenTen}</div>`;
                }
                
                if (okurigana && showOkurigana) {
                    innerHTML += `<div class="okurigana">${okurigana}</div>`;
                }
                
                kanjiItem.innerHTML = innerHTML;
                kanjiContainer.appendChild(kanjiItem);
            });
            
            sentenceBox.appendChild(kanjiContainer);
            container.appendChild(sentenceBox);
            
            updatePosition();
        }

        // åˆ‡æ¢æ¨ªç«–æ’
        function toggleLayout() {
            const container = document.querySelector('.kanji-container');
            if (container) {
                container.classList.toggle('vertical');
                
                container.style.opacity = '0.5';
                setTimeout(() => {
                    container.style.opacity = '1';
                    updatePosition();
                }, 300);
            }
        }

        // æ›´æ–°å­—ä½“å¤§å°
        function updateFontSize() {
            const slider = document.getElementById('fontSizeSlider');
            const fontSizeValue = document.getElementById('fontSizeValue');
            const kanjiElements = document.querySelectorAll('.kanji');
            
            const fontSize = slider.value + 'px';
            fontSizeValue.textContent = fontSize;
            
            kanjiElements.forEach(element => {
                element.style.fontSize = fontSize;
            });
        }

        // æ›´æ–°è¿”ç‚¹å’Œé€å‡åçš„ä½ç½®
        function updatePosition() {
            const tenX = parseInt(document.getElementById('tenXSlider').value);
            const tenY = parseInt(document.getElementById('tenYSlider').value);
            const okuX = parseInt(document.getElementById('okuXSlider').value);
            const okuY = parseInt(document.getElementById('okuYSlider').value);
            
            document.getElementById('tenXValue').textContent = tenX;
            document.getElementById('tenYValue').textContent = tenY;
            document.getElementById('okuXValue').textContent = okuX;
            document.getElementById('okuYValue').textContent = okuY;
            
            const tenElements = document.querySelectorAll('.ten-ten');
            const okuElements = document.querySelectorAll('.okurigana');
            const isVertical = document.querySelector('.kanji-container')?.classList.contains('vertical') || false;
            
            tenElements.forEach(el => {
                if (isVertical) {
                    el.style.left = `calc(-15px + ${tenX}px)`;
                    el.style.top = `calc(20px + ${tenY}px)`;
                } else {
                    el.style.left = `calc(10px + ${tenX}px)`;
                    el.style.bottom = `calc(10px + ${tenY}px)`;
                }
            });
            
            okuElements.forEach(el => {
                if (isVertical) {
                    el.style.right = `calc(-15px + ${okuX}px)`;
                    el.style.bottom = `calc(20px + ${okuY}px)`;
                } else {
                    el.style.right = `calc(10px + ${okuX}px)`;
                    el.style.bottom = `calc(10px + ${okuY}px)`;
                }
            });
        }

        // æ¸…ç©ºæ‰€æœ‰å†…å®¹
        function clearAll() {
            document.getElementById('kanjiInput').value = '';
            document.getElementById('tenInput').value = '';
            document.getElementById('okuriganaInput').value = '';
            document.getElementById('formattedInput').value = '';
            document.getElementById('kanjiContainer').innerHTML = '';
            document.getElementById('formatError').style.display = 'none';
        }

        // å½“å¤é€‰æ¡†çŠ¶æ€æ”¹å˜æ—¶é‡æ–°æ¸²æŸ“
        function handleCheckboxChange() {
            const kanjiContainer = document.querySelector('.kanji-container');
            const isVertical = kanjiContainer ? kanjiContainer.classList.contains('vertical') : true;
            
            generateKundoku();
            
            setTimeout(() => {
                const newContainer = document.querySelector('.kanji-container');
                if (newContainer && isVertical !== newContainer.classList.contains('vertical')) {
                    newContainer.classList.toggle('vertical');
                }
            }, 0);
        }

        // ç»‘å®šäº‹ä»¶
        document.getElementById('showTenTen').addEventListener('change', handleCheckboxChange);
        document.getElementById('showOkurigana').addEventListener('change', handleCheckboxChange);
        document.getElementById('showBoxes').addEventListener('change', handleCheckboxChange);

        // é¡µé¢åŠ è½½æ—¶ç”Ÿæˆé»˜è®¤ç¤ºä¾‹
        window.onload = function() {
            loadExample('example1');
        };
    </script>
</body>
</html>
